# -------------------------------------------------------------
# ๐จโ๐ป Developed by: MTMA
# ๐ง Email: mtma.1@hotmail.com
# ๐ Website: iq.sa
#
# ุชู ุฏูุฌ ูุฐุง ุงูููุฏ ูุน ููุชุจุฉ Streamlit ูุชุญูููู ุฅูู ุตูุญุฉ ููุจ ุชูุงุนููุฉ
# -------------------------------------------------------------

import streamlit as st
import numpy as np

# --- ุงูุฌุฒุก ุงูุฃูู: ุฅุนุฏุงุฏ ูุชุฏุฑูุจ ุงููููุฐุฌ (ูุฐุง ุงูุฌุฒุก ูุง ูุชุบูุฑ) ---

# 1. ุจูุงูุงุช ุงูุชุฏุฑูุจ (ูุณุงุญุฉุ ุบุฑูุ ุทูุงุจูุ ุฌูุฏุฉ ุงูุชุดุทูุจุ ุงูุญู)
x_train = np.array([
    [50, 1, 1, 1, 3], [60, 1, 2, 2, 3], [100, 3, 2, 4, 2],
    [120, 3, 3, 5, 1], [150, 4, 3, 4, 1], [110, 2, 2, 3, 2],
    [170, 4, 4, 5, 1], [200, 5, 4, 5, 1], [90, 2, 2, 2, 2],
    [180, 4, 3, 4, 1],
])
y_train = np.array([380000, 420000, 650000, 780000, 950000, 710000, 1100000, 1350000, 600000, 1200000])

# 3. Feature Scaling
x_mean = np.mean(x_train, axis=0)
x_range = np.max(x_train, axis=0) - np.min(x_train, axis=0)
x_scaled = (x_train - x_mean) / x_range

# 4. ุฅุนุฏุงุฏุงุช ุงููููุฐุฌ
w = np.zeros(x_train.shape[1])
b = 1e-6
alpha = 0.001
epochs = 50000
m = x_train.shape[0]

# 5. ุฏุงูุฉ ุงูููุณุช
def compute_cost(x, y, w, b):
    m = x.shape[0]
    y_hat = np.dot(x, w) + b
    cost = (1 / (2 * m)) * np.sum((y_hat - y) ** 2)
    return cost

# 6. ุชุฏุฑูุจ ุงููููุฐุฌ (ุณูุชู ุชุดุบููู ูุฑุฉ ูุงุญุฏุฉ ุนูุฏ ุจุฏุก ุงูุชุทุจูู)
# ูุง ุชููู ูู ุงูู print ููุงุ ุณุชุธูุฑ ูู ุงูุทุฑููุฉ (Terminal) ุนูุฏ ุงูุชุดุบูู
# ููู ูููุฏุฉ ููุชุฃูุฏ ูู ุฃู ุงูุชุฏุฑูุจ ูุฏ ุชู ุจูุฌุงุญ
for i in range(epochs):
    y_hat = np.dot(x_scaled, w) + b
    error = y_hat - y_train
    gradient_w = (1 / m) * np.dot(x_scaled.T, error)
    gradient_b = (1 / m) * np.sum(error)
    w = w - alpha * gradient_w
    b = b - alpha * gradient_b
# --- ููุงูุฉ ุฌุฒุก ุงูุชุฏุฑูุจ ---


# --- ุงูุฌุฒุก ุงูุซุงูู: ุจูุงุก ูุงุฌูุฉ ุงููุณุชุฎุฏู ุงูุชูุงุนููุฉ ุจุงุณุชุฎุฏุงู Streamlit ---

# ุนููุงู ุงูุตูุญุฉ ููุตููุง
st.title("BY:MTMA ูููุฐุฌ ุชูุฏูุฑ ุฃุณุนุงุฑ ุงูุนูุงุฑุงุช ุจุงูุฑูุงุถ")
st.write("ุชู ุชุทููุฑ ูุฐุง ุงููููุฐุฌ ูุฃุฏุงุฉ ุชุนููููุฉ ูููู ุฃุณุงุณูุงุช ุงูุงูุญุฏุงุฑ ุงูุฎุทู ูู ุชุนูู ุงูุขูุฉ.")
st.markdown("---") # ุฎุท ูุงุตู

# ุฅูุดุงุก ุฃุนูุฏุฉ ูุชูุธูู ุงููุงุฌูุฉ
col1, col2 = st.columns(2)

with col1:
    st.subheader("ุฎุตุงุฆุต ุงูุนูุงุฑ")
    # ุงุณุชุจุฏุงู input() ุจู st.number_input ููุงุฌูุฉ ุฃูุถู
    area = st.number_input("ุงููุณุงุญุฉ (ูุชุฑ ูุฑุจุน)", min_value=30, max_value=500, value=120)
    rooms = st.number_input("ุนุฏุฏ ุงูุบุฑู", min_value=1, max_value=10, value=3)
    floors = st.number_input("ุนุฏุฏ ุงูุทูุงุจู", min_value=1, max_value=5, value=2)

with col2:
    st.subheader("ุชููููุงุช ุฅุถุงููุฉ")
    # ุงุณุชุจุฏุงู input() ุจู st.slider ููุงุฌูุฉ ุชูุงุนููุฉ ุฃูุซุฑ
    finishing = st.slider("ุฌูุฏุฉ ุงูุชุดุทูุจ (1 ุณูุก - 5 ููุชุงุฒ)", 1, 5, 4)
    neighborhood = st.slider("ูุณุชูู ุงูุญู (1 ูุงุฎุฑ - 3 ุดุนุจู)", 1, 3, 2)

# ุฒุฑ ุงูุชูุฏูุฑ ูุงูุนูููุฉ ุงูุชู ุชุญุฏุซ ุนูุฏ ุงูุถุบุท ุนููู
if st.button("ุชูุฏูุฑ ุงูุณุนุฑ ุงูุขู"):
    # 8. ุชุญููู ูุชุทุจูู Feature Scaling ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู
    x_user = np.array([[area, rooms, floors, finishing, neighborhood]])
    x_user_scaled = (x_user - x_mean) / x_range

    # 9. ุงูุชูุจุค ุจุงูุณุนุฑ
    y_user_pred = np.dot(x_user_scaled, w) + b
    
    # ุนุฑุถ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ุจุดูู ุฃููู ุนูู ุงูุตูุญุฉ
    st.markdown("---")
    st.header("ุงููุชูุฌุฉ")
    st.success(f"๐ฐ ุงูุณุนุฑ ุงูุชูุฏูุฑู ููุนูุงุฑ ูู: **{int(y_user_pred[0]):,} ุฑูุงู ุณุนูุฏู**")
    
    # 10. ุนุฑุถ ุงูููุงุญุธุฉ ุงููุงูุฉ
    st.warning("โ๏ธ ุงููููุฐุฌ ุจุงูุฃุตู ูุนุทูู ููุฑุฉ ุนู ุงูููุงููู ุงูุฑูุงุถูุฉ ุงูุฃุณุงุณูุฉ ุจุชุนูู ุงูุขูุฉ ูููุณ ุจุงูุถุฑูุฑุฉ ูุณุชุฎุฏู ูููุงุณ ุฃุฑูุงู ุญููููุฉ.")

# ูุถุน ูุนูููุงุช ุงูุชูุงุตู ูู ุงูุฃุณูู
st.markdown("---")
st.write("๐จโ๐ป Developed by: MTMA | ๐ง Email: mtma.1@hotmail.com | ๐ Website: iq.sa")